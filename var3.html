<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Интерактивный вариант заданий (Новый)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Chosen Palette: Warm Neutrals -->
  <!-- Application Structure Plan: Я разработал структуру в виде интерактивной панели управления (dashboard). Центральным элементом является область для отображения одного выбранного задания, что позволяет пользователю сфокусироваться на конкретной задаче. Навигация осуществляется через боковую панель с сеткой всех заданий и фильтрами по категориям (Алгебра, Геометрия и т.д.). Такой подход обеспечивает нелинейный доступ к контенту, а скрытие решений по умолчанию стимулирует самостоятельную работу. Эта структура выбрана для преобразования статичного списка задач в удобный интерактивный инструмент для обучения и самопроверки. -->
  <!-- Visualization & Content Choices:
      - Общая структура: Задачи представлены в виде "карточек" с кнопкой "Показать решение", чтобы скрыть ответ до попытки решения (Цель: Стимулировать активное обучение).
      - Задание 10 (Таблица гостиниц): Цель -> Анализ данных таблицы и выбор оптимального варианта. Метод -> Таблица с данными и текстовое описание. Интеракция -> Пользовательский ввод 'k' влияет на цены и условия. Обоснование -> Позволяет наглядно оценить варианты с учетом динамических цен.
      - Задание 11 (План участка): Цель -> Расчет площади с учетом новых условий. Метод -> Текстовое описание с формулами. Интеракция -> Изменение 'k' влияет на размеры участка и площадь забора.
      - Задание 12 (Логарифмическое выражение): Цель -> Вычисление логарифмического выражения. Метод -> Текстовое описание с пошаговым решением. Интеракция -> Значение 'k' влияет на конечное числовое значение.
      - Задание 13 (Букет роз): Цель -> Решение текстовой задачи с динамическими ценами. Метод -> Текстовое описание с расчетами. Интеракция -> Изменение 'k' влияет на количество покупаемых роз и общую стоимость.
      - Задание 14 (Конус): Цель -> Расчет площади поверхности конуса. Метод -> Текстовое описание с формулами. Интеракция -> Изменение 'k' влияет на радиус и образующую конуса.
      - Задание 15 (Четырехугольная пирамида): Цель -> Расчет объема пирамиды. Метод -> Текстовое описание с формулами. Интеракция -> Изменение 'k' влияет на стороны основания.
      - Задание 16 (Шары): Цель -> Сравнение объемов и площадей поверхностей шаров. Метод -> Текстовое описание с расчетами. Интеракция -> Изменение 'k' влияет на радиусы шаров.
      - Задание 17 (Цилиндр): Цель -> Расчет площади полной поверхности цилиндра. Метод -> Текстовое описание с формулами. Интеракция -> Изменение 'k' влияет на диаметр и высоту цилиндра.
      - Задание 18 (Сфера): Цель -> Расчет площади поверхности сферы. Метод -> Текстовое описание с формулами. Интеракция -> Изменение 'k' влияет на радиус сферы.
  -->
  <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #FDFBF8; /* Warm neutral background */
    }
    .task-card {
      background-color: #FFFFFF;
      border: 1px solid #EAE6E1;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .nav-button {
      transition: all 0.2s ease-in-out;
    }
    .nav-button.active {
      background-color: #A88B79; /* Muted Accent */
      color: #FFFFFF;
      transform: scale(1.05);
    }
    .nav-button:not(.active):hover {
      background-color: #EAE6E1;
    }
    .category-button {
      transition: all 0.2s ease-in-out;
    }
    .category-button.active {
      background-color: #3D352F; /* Darker Neutral */
      color: #FFFFFF;
    }
    .category-button:not(.active):hover {
      background-color: #EAE6E1;
    }
    .solution-toggle {
      background-color: #A88B79;
      color: white;
    }
    .solution-toggle:hover {
      background-color: #937866;
    }
    .solution-content {
      background-color: #F9F7F5;
      border-left: 3px solid #A88B79;
    }
    .chart-container {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      height: 300px;
      max-height: 400px;
    }
    @media (min-width: 768px) {
      .chart-container {
        height: 350px;
      }
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
  <script type="module" crossorigin src="/my-vite-multi-page-site/assets/select-navigator-D_c_TUIC.js"></script>
</head>
<body class="text-gray-800">
<div class="container mx-auto p-4 md:p-8">
  <header class="text-center mb-8">
    <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Интерактивный вариант заданий</h1>
    <select name="pages" id="page-selector">
      <option value="">Выберите страницу</option>
      <option value="/my-vite-multi-page-site/index.html">Вариант 1</option>
      <option value="/my-vite-multi-page-site/var2.html">Вариант 2</option>
      <option value="/my-vite-multi-page-site/var3.html">Вариант 3</option>
      <option value="/my-vite-multi-page-site/var4.html">Вариант 4</option>
    </select>


    <p class="text-lg text-gray-600 mt-2">Все расчеты выполнены с учетом <code class="bg-gray-200 text-gray-800 font-bold px-2 py-1 rounded"><span id="current-k-display">k = 3</span></code></p>
    <div class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-2">
      <label for="k-input" class="text-gray-700 font-semibold">Изменить k:</label>
      <input type="number" id="k-input" value="3" min="1" step="1"
             class="w-24 px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
      <button id="apply-k-button" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200">Применить</button>
    </div>
  </header>

  <div class="flex flex-col md:flex-row gap-8">
    <aside class="w-full md:w-1/3 lg:w-1/4">
      <div class="sticky top-8">
        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
          <h3 class="font-bold text-lg mb-4 text-center">Навигация</h3>
          <div class="mb-6">
            <h4 class="font-semibold text-md mb-2 text-gray-700">Категории:</h4>
            <div id="category-filters" class="flex flex-wrap gap-2"></div>
          </div>
          <h4 class="font-semibold text-md mb-2 text-gray-700">Задания:</h4>
          <div id="task-navigation" class="grid grid-cols-4 sm:grid-cols-5 md:grid-cols-4 gap-2">
          </div>
        </div>
      </div>
    </aside>

    <main id="task-content" class="w-full md:w-2/3 lg:w-3/4">
    </main>
  </div>
</div>

<script>
  const tasks = [
    {
      id: 1,
      category: 'Алгебра',
      question: 'Найдите значение выражения: $\\frac{15k}{7} + \\frac{9k}{7} - \\frac{(2+3k)}{3k}$',
      solution: (k) => {
        if (k === 0) {
          return `
                            <p class="mb-2 text-red-600">Деление на ноль: Значение k не может быть равно 0 в этом выражении.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (k=0)</span></p>
                        `;
        }
        const val = (15 * k) / 7 + (9 * k) / 7 - (2 + 3 * k) / (3 * k);
        return `
                        <p class="mb-2">1. Сложим первые два члена:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\frac{15k}{7} + \\frac{9k}{7} = \\frac{24k}{7}$</p>
                        <p class="mb-2">2. Упростим третий член:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\frac{2+3k}{3k} = \\frac{2}{3k} + \\frac{3k}{3k} = \\frac{2}{3k} + 1$</p>
                        <p class="mb-2">3. Выполним вычитание:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\frac{24k}{7} - (\\frac{2}{3k} + 1) = \\frac{24k}{7} - \\frac{2}{3k} - 1$</p>
                        <p class="mb-2">4. Приведем к общему знаменателю и вычислим (для k=${k}):</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\frac{24 \\cdot ${k}}{7} - \\frac{2}{3 \\cdot ${k}} - 1 = ${val.toFixed(3)}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${val.toFixed(3)}</span></p>
                    `;
      }
    },
    {
      id: 2,
      category: 'Алгебра',
      question: 'Найдите значение выражения: $\\frac{k^9}{k^{10} \\cdot k^{-3}}$',
      solution: (k) => {
        if (k === 0) {
          return `
                            <p class="mb-2 text-red-600">Деление на ноль: Значение k не может быть равно 0 в этом выражении.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (k=0)</span></p>
                        `;
        }
        const val = k**2; // k^9 / (k^(10-3)) = k^9 / k^7 = k^(9-7) = k^2
        return `
                        <p class="mb-2">1. Упростим знаменатель, используя свойство степеней $a^m \\cdot a^n = a^{m+n}$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$k^{10} \\cdot k^{-3} = k^{10 + (-3)} = k^7$</p>
                        <p class="mb-2">2. Теперь выражение выглядит как:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\frac{k^9}{k^7}$</p>
                        <p class="mb-2">3. Упростим, используя свойство степеней $\\frac{a^m}{a^n} = a^{m-n}$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$k^{9-7} = k^2$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${val}</span></p>
                    `;
      }
    },
    {
      id: 3,
      category: 'Текстовые задачи',
      question: 'В магазине вся мебель продаётся в разобранном виде. Покупатель может заказать сборку мебели на дому, стоимость которой составляет 7% от стоимости купленной мебели. Шкаф стоит $32000k$ рублей. Во сколько рублей обойдётся покупка этого шкафа вместе со сборкой?',
      solution: (k) => {
        const cabinetPrice = 32000 * k;
        const assemblyCost = cabinetPrice * 0.07;
        const totalCost = cabinetPrice + assemblyCost;
        return `
                        <p class="mb-2">1. Стоимость шкафа: $32000 \\cdot ${k} = ${cabinetPrice}$ рублей.</p>
                        <p class="mb-2">2. Стоимость сборки (7% от стоимости шкафа): $0.07 \\cdot ${cabinetPrice} = ${assemblyCost.toFixed(2)}$ рублей.</p>
                        <p class="mb-2">3. Общая стоимость (шкаф + сборка): ${cabinetPrice} + ${assemblyCost.toFixed(2)} = ${totalCost.toFixed(2)}$ рублей.</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${totalCost.toFixed(2)} рублей</span></p>
                    `;
      }
    },
    {
      id: 4,
      category: 'Геометрия',
      question: 'Площадь поверхности прямоугольного параллелепипеда с рёбрами $a, b, c$ вычисляется по формуле $S = 2(ab + ac + bc)$. Найдите площадь поверхности прямоугольного параллелепипеда с рёбрами $2+k$, $4k$ и $6+k$.',
      solution: (k) => {
        const a = 2 + k;
        const b = 4 * k;
        const c = 6 + k;
        const surfaceArea = 2 * (a * b + a * c + b * c);
        return `
                        <p class="mb-2">1. Длины рёбер параллелепипеда (для k=${k}):</p>
                        <ul class="list-disc list-inside ml-4">
                            <li>$a = 2 + ${k} = ${a}$</li>
                            <li>$b = 4 \\cdot ${k} = ${b}$</li>
                            <li>$c = 6 + ${k} = ${c}$</li>
                        </ul>
                        <p class="mb-2">2. Подставим значения в формулу площади поверхности $S = 2(ab + ac + bc)$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$S = 2((${a})(${b}) + (${a})(${c}) + (${b})(${c}))$</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$S = 2(${a*b} + ${a*c} + ${b*c}) = 2(${a*b + a*c + b*c}) = ${surfaceArea}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${surfaceArea}</span></p>
                    `;
      }
    },
    {
      id: 5,
      category: 'Тригонометрия',
      question: 'Определите значение $\\sin x$, если $\\cos x = \\frac{\\sqrt{21k}}{5\\sqrt{k}}$ и $0^\\circ < x < 90^\\circ$.',
      solution: (k) => {
        if (k <= 0) {
          return `
                            <p class="mb-2 text-red-600">Недопустимое значение k: k должно быть положительным для корня.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (недопустимое значение k)</span></p>
                        `;
        }
        const cos_x = Math.sqrt(21 * k) / (5 * Math.sqrt(k)); // This simplifies to Math.sqrt(21) / 5
        const simplified_cos_x = Math.sqrt(21) / 5;

        let sin_x = "невозможно вычислить";
        let error = false;

        if (Math.abs(simplified_cos_x) > 1 + 1e-9) { // Add a small epsilon for floating point inaccuracies
          error = true;
        } else {
          // sin^2(x) = 1 - cos^2(x)
          const sin_x_squared = 1 - simplified_cos_x**2;
          // Since 0 < x < 90, x is in the 1st quadrant, where sin(x) is positive.
          sin_x = Math.sqrt(sin_x_squared);
        }

        if (error) {
          return `
                            <p class="mb-2">1. Упростим $\\cos x$:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\cos x = \\frac{\\sqrt{21k}}{5\\sqrt{k}} = \\frac{\\sqrt{21}\\sqrt{k}}{5\\sqrt{k}} = \\frac{\\sqrt{21}}{5} \\approx ${simplified_cos_x.toFixed(4)}$</p>
                            <p class="mb-2 text-red-600">Значение $\\cos x$ (${simplified_cos_x.toFixed(4)}) выходит за пределы допустимого диапазона [-1, 1].</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить ($\\cos x$ вне диапазона)</span></p>
                        `;
        }

        return `
                        <p class="mb-2">1. Упростим $\\cos x$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\cos x = \\frac{\\sqrt{21k}}{5\\sqrt{k}} = \\frac{\\sqrt{21}\\sqrt{k}}{5\\sqrt{k}} = \\frac{\\sqrt{21}}{5} \\approx ${simplified_cos_x.toFixed(4)}$</p>
                        <p class="mb-2">2. Используем основное тригонометрическое тождество $\\sin^2 x + \\cos^2 x = 1$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\sin^2 x = 1 - \\cos^2 x = 1 - (\\frac{\\sqrt{21}}{5})^2 = 1 - \\frac{21}{25} = \\frac{4}{25}$</p>
                        <p class="mb-2">3. Поскольку $0^\\circ < x < 90^\\circ$ (I четверть), $\\sin x$ должен быть положительным:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\sin x = \\sqrt{\\frac{4}{25}} = \\frac{2}{5} = ${sin_x.toFixed(4)}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${sin_x.toFixed(4)}</span></p>
                    `;
      }
    },
    {
      id: 6,
      category: 'Вероятность',
      question: 'На семинар приехали $7+2k$ учёных из Норвегии, $5+k$ из России и $3+k$ из Испании. Каждый учёный подготовил один доклад. Порядок докладов определяется случайным образом. Найдите вероятность того, что восьмым окажется доклад учёного из России.',
      solution: (k) => {
        const norwayScientists = 7 + 2 * k;
        const russiaScientists = 5 + k;
        const spainScientists = 3 + k;
        const totalScientists = norwayScientists + russiaScientists + spainScientists;

        let probability = 0;
        if (totalScientists > 0) {
          probability = russiaScientists / totalScientists;
        }

        if (totalScientists <= 0 || russiaScientists < 0 || norwayScientists < 0 || spainScientists < 0) {
          return `
                            <p class="mb-2 text-red-600">Некорректные данные: Количество учёных не может быть отрицательным или равно нулю. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (некорректные данные)</span></p>
                        `;
        }

        return `
                        <p class="mb-2">1. Количество учёных из Норвегии: $7 + 2 \\cdot ${k} = ${norwayScientists}$.</p>
                        <p class="mb-2">2. Количество учёных из России: $5 + ${k} = ${russiaScientists}$.</p>
                        <p class="mb-2">3. Количество учёных из Испании: $3 + ${k} = ${spainScientists}$.</p>
                        <p class="mb-2">4. Общее количество учёных: ${norwayScientists} + ${russiaScientists} + ${spainScientists} = ${totalScientists}$.</p>
                        <p class="mb-2">5. Вероятность того, что восьмым окажется доклад учёного из России:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$P = \\frac{\\text{Количество учёных из России}}{\\text{Общее количество учёных}} = \\frac{${russiaScientists}}{${totalScientists}} = ${probability.toFixed(3)}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${probability.toFixed(3)}</span></p>
                    `;
      }
    },
    {
      id: 7,
      category: 'Алгебра',
      question: 'Решите неравенство: $5^{2x-k} \\ge 5^{10kx+3}$',
      solution: (k) => {
        let solutionText;
        if (2 - 10 * k === 0) {
          if (-k - 3 <= 0) {
            solutionText = `
                                <p class="mb-2">Если $2 - 10k = 0$, т.е. $k=\\frac{1}{5}$, то неравенство становится $ -k \\ge 3 $, что является истиной. В этом случае $x \\in \\mathbb{R}$.</p>
                                <p class="font-bold text-lg">Ответ: <span class="text-green-700">$x \\in \\mathbb{R}$</span> (для k=${k})</p>
                            `;
          } else {
            solutionText = `
                                <p class="mb-2">Если $2 - 10k = 0$, т.e. $k=\\frac{1}{5}$, то неравенство становится $ -k \\ge 3 $, что является ложью. В этом случае решений нет.</p>
                                <p class="font-bold text-lg">Ответ: <span class="text-red-600">Нет решений</span> (для k=${k})</p>
                            `;
          }
        } else if (2 - 10 * k > 0) {
          const val = (-k - 3) / (2 - 10 * k);
          solutionText = `
                            <p class="mb-2">Поскольку основания равны и больше 1, мы можем сравнить показатели:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$2x - k \\ge 10kx + 3$</p>
                            <p class="mb-2">Перегруппируем члены:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$(2 - 10k)x \\ge k + 3$</p>
                            <p class="mb-2">Так как $2 - 10k > 0$ (для $k < 1/5$), делим на $2 - 10k$ и меняем знак неравенства:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$x \\ge \\frac{-k - 3}{2 - 10k} = ${val.toFixed(3)}$</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-green-700">$x \\ge \\frac{-k - 3}{2 - 10k} = ${val.toFixed(3)}$</span></p>
                        `;
        } else { // 2 - 10k < 0
          const val = (-k - 3) / (2 - 10 * k);
          solutionText = `
                            <p class="mb-2">Поскольку основания равны и больше 1, мы можем сравнить показатели:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$2x - k \\ge 10kx + 3$</p>
                            <p class="mb-2">Перегруппируем члены:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$(2 - 10k)x \\ge k + 3$</p>
                            <p class="mb-2">Так как $2 - 10k < 0$ (для $k > 1/5$), делим на $2 - 10k$ и меняем знак неравенства:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$x \\le \\frac{-k - 3}{2 - 10k} = ${val.toFixed(3)}$</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-green-700">$x \\le \\frac{-k - 3}{2 - 10k} = ${val.toFixed(3)}$</span></p>
                        `;
        }
        return solutionText;
      }
    },
    {
      id: 8,
      category: 'Алгебра',
      question: 'Найдите корень уравнения $\\sqrt{k^2 - 4x} = 6$',
      solution: (k) => {
        const discriminant = 36 - k**2; // 6^2 - k^2
        let solutionText;

        if (discriminant < 0) {
          solutionText = `
                            <p class="mb-2">1. Возведем обе части уравнения в квадрат:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$k^2 - 4x = 36$</p>
                            <p class="mb-2">2. Выразим $x$:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$-4x = 36 - k^2$</p>
                            <p class="mb-2 text-red-600">Выражение под корнем отрицательно ($k^2 - 36 < 0$, т.е. $|k| > 6$), решений нет.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Нет решений</span></p>
                        `;
        } else {
          const val = (k**2 - 36) / 4;
          solutionText = `
                            <p class="mb-2">1. Возведем обе части уравнения в квадрат:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$k^2 - 4x = 36$</p>
                            <p class="mb-2">2. Выразим $x$:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$-4x = 36 - k^2$</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$4x = k^2 - 36$</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$x = \\frac{k^2 - 36}{4} = ${val.toFixed(3)}$</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-green-700">${val.toFixed(3)}</span></p>
                        `;
        }
        return solutionText;
      }
    },
    {
      id: 9,
      category: 'Тригонометрия',
      question: 'Найдите корень уравнения: $\\cos kx = -1$. (Ответ переведите из радианной меры угла в градусную меру угла)',
      solution: (k) => {
        if (k === 0) {
          return `
                            <p class="mb-2 text-red-600">Для $k=0$, $\\cos(0) = 1 \\neq -1$. Уравнение не имеет решений.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Нет решений</span></p>
                        `;
        }
        // cos A = -1 => A = pi + 2*pi*n
        // kx = pi + 2*pi*n
        // x = (pi + 2*pi*n) / k = pi(1 + 2n) / k
        // For simplest positive solution, let n=0, x = pi/k
        const x_rad = Math.PI / k;
        const x_deg = (x_rad * 180) / Math.PI; // Convert to degrees

        return `
                        <p class="mb-2">1. Общее решение для $\\cos A = -1$ это $A = \\pi + 2\\pi n$, где $n$ - целое число.</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$kx = \\pi + 2\\pi n$</p>
                        <p class="mb-2">2. Если $k \\neq 0$, то:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$x = \\frac{\\pi + 2\\pi n}{k} = \\frac{\\pi(1 + 2n)}{k}$</p>
                        <p class="mb-2">3. Для $n=0$, $x = \\frac{\\pi}{k}$ радиан.</p>
                        <p class="mb-2">4. Переведем в градусы:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$x = \\frac{\\pi}{k} \\cdot \\frac{180^\\circ}{\\pi} = \\frac{180^\\circ}{k}$</p>
                        <p class="mb-2 text-gray-600">Примечание: Это одно из возможных решений. Все решения имеют вид $\\frac{180^\\circ(1+2n)}{k}$, где $n \\in \\mathbb{Z}$.</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">$\\frac{180^\\circ}{k} = ${x_deg.toFixed(2)}^\\circ$</span></p>
                    `;
      }
    },
    {
      id: 10,
      category: 'Текстовые задачи',
      question: 'Сергей Петрович собирается в туристическую поездку на трое суток в некоторый город. В таблице дана информация о гостиницах в этом городе со свободными номерами на время его поездки. Сергей Петрович хочет остановиться в гостинице, которая находится не далее 2.5 км от центральной площади и рейтинг которой не ниже 8.5. Среди гостиниц, удовлетворяющих этим условиям, выберите гостиницу с наименьшей ценой номера за сутки. Сколько рублей обойдётся покупка в этой гостинице в течение трёх суток?',
      data: {
        headers: ['Название гостиницы', 'Рейтинг гостиницы', 'Расстояние до центральной площади (км)', 'Цена номера (руб. в сутки)'],
        rows: [
          ['«Красноярск»', 8.8, 1.5, (k) => 4000 + 100 * k],
          ['«Октябрь»', 8.7, 1.8, (k) => 4004 + 50 * k],
          ['«Салют»', 9.2, 2.0, (k) => 3104 + 200 * k],
          ['«Восход»', 7.0, 2.3, (k) => 3104 + 150 * k],
          ['«Заря»', 8.0, 3.5, (k) => 2000 + 120 * k],
          ['«Север»', 8.6, 1.5, (k) => 2004 + 80 * k]
        ]
      },
      solution: (k) => {
        const maxDistance = 2.5;
        const minRating = 8.5;
        const stayDuration = 3; // days

        let eligibleHotels = [];
        tasks[9].data.rows.forEach(row => { // Task 10 data is at index 9
          const hotelName = row[0];
          const rating = row[1];
          const distance = row[2];
          const price = row[3](k); // Calculate price based on k

          if (distance <= maxDistance && rating >= minRating) {
            eligibleHotels.push({ name: hotelName, rating: rating, distance: distance, price: price });
          }
        });

        if (eligibleHotels.length === 0) {
          return `<p class="mb-2 text-red-600">Нет гостиниц, удовлетворяющих условиям (расстояние не более ${maxDistance} км, рейтинг не ниже ${minRating}). Попробуйте изменить k.</p>`;
        }

        // Sort by price to find the minimum
        eligibleHotels.sort((a, b) => a.price - b.price);
        const chosenHotel = eligibleHotels[0];
        const totalCost = chosenHotel.price * stayDuration;

        let tableHtml = `
                        <table class="min-w-full bg-white border border-gray-300 rounded-md overflow-hidden">
                            <thead>
                                <tr>
                                    <th class="py-2 px-4 border-b">Название гостиницы</th>
                                    <th class="py-2 px-4 border-b">Рейтинг</th>
                                    <th class="py-2 px-4 border-b">Расстояние (км)</th>
                                    <th class="py-2 px-4 border-b">Цена (руб/сутки)</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
        tasks[9].data.rows.forEach(row => {
          const price = row[3](k);
          const isEligible = eligibleHotels.some(hotel => hotel.name === row[0]);
          const isChosen = chosenHotel && chosenHotel.name === row[0];
          tableHtml += `<tr class="${isChosen ? 'bg-green-100 font-bold' : isEligible ? 'bg-blue-50' : ''}">
                                <td>${row[0]}</td>
                                <td>${row[1]}</td>
                                <td>${row[2]}</td>
                                <td>${price.toFixed(2)}</td>
                            </tr>`;
        });
        tableHtml += `</tbody></table>`;


        return `
                        <p class="mb-4">Информация о гостиницах (цены рассчитаны для k=${k}):</p>
                        ${tableHtml}
                        <p class="mb-2">Гостиницы, удовлетворяющие условиям (расстояние не более ${maxDistance} км, рейтинг не ниже ${minRating}):</p>
                        <ul class="list-disc list-inside ml-4">
                            ${eligibleHotels.map(h => `<li>${h.name} (Рейтинг: ${h.rating}, Расстояние: ${h.distance} км, Цена: ${h.price.toFixed(2)} руб./сутки)</li>`).join('')}
                        </ul>
                        <p class="mt-4 font-bold">Выбранная гостиница: <span class="text-green-700">${chosenHotel.name}</span> (Цена за сутки: ${chosenHotel.price.toFixed(2)} руб.)</p>
                        <p class="font-bold text-lg">Общая стоимость за ${stayDuration} суток: <span class="text-green-700">${totalCost.toFixed(2)} рублей</span></p>
                    `;
      }
    },
    {
      id: 11,
      category: 'Геометрия',
      question: 'Участок земли для строительства дачи имеет форму прямоугольника, стороны которого равны $25+2k$ м и $30+k$ м. Одна из больших сторон участка идёт вдоль реки, а три остальные стороны нужно огородить забором. Найдите длину этого забора. Ответ дайте в метрах.',
      solution: (k) => {
        const side1 = 25 + 2 * k;
        const side2 = 30 + k;

        // Identify the larger side to be along the river
        const riverSide = Math.max(side1, side2);
        const otherSide1 = Math.min(side1, side2);
        const otherSide2 = otherSide1; // The other side (width) is repeated for perimeter

        // The three sides to be fenced: two shorter sides and one longer side (not along the river)
        const fenceLength = otherSide1 + otherSide2 + riverSide;

        if (side1 === side2) { // Square case
          return `
                            <p class="mb-2">Стороны участка (для k=${k}): ${side1} м и ${side2} м. Так как стороны равны, участок - квадрат.</p>
                            <p class="mb-2">Длина забора будет равна сумме трех сторон:</p>
                            <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">Длина забора = ${side1} + ${side2} + ${side1} = ${3 * side1} м.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-green-700">${3 * side1} м</span></p>
                        `;
        }

        return `
                        <p class="mb-2">Стороны участка (для k=${k}): ${side1} м и ${side2} м.</p>
                        <p class="mb-2">Большая сторона (${riverSide} м) идёт вдоль реки и не огораживается. Огораживаются две меньшие стороны и одна большая, не вдоль реки.</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">Длина забора = 2 * (меньшая сторона) + (большая сторона) = 2 * ${otherSide1} + ${riverSide} = ${fenceLength} м.</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${fenceLength} м</span></p>
                    `;
      }
    },
    {
      id: 12,
      category: 'Алгебра',
      question: 'Вычислите $\\log_k 0.1k + \\log_k 10$',
      solution: (k) => {
        if (k <= 0 || k === 1) {
          return `
                            <p class="mb-2 text-red-600">Недопустимое значение k для основания логарифма ($k > 0$ и $k \\neq 1$).</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (недопустимое значение k)</span></p>
                        `;
        }
        const val = 1; // log_k(0.1k * 10) = log_k(k) = 1
        return `
                        <p class="mb-2">1. Используем свойство логарифмов $\\log_a M + \\log_a N = \\log_a (M \\cdot N)$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\log_k (0.1k \\cdot 10)$</p>
                        <p class="mb-2">2. Умножим выражения внутри логарифма:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\log_k (k)$</p>
                        <p class="mb-2">3. По определению логарифма $\\log_a a = 1$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$1$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${val}</span></p>
                    `;
      }
    },
    {
      id: 13,
      category: 'Текстовые задачи',
      question: 'На день рождения полагается дарить букет из нечётного числа цветов. Розы стоят $90$ рублей за штуку. У Вани есть $55 + 120k$ рублей. Из какого наибольшего нечётного числа роз он может купить букет на день рождения?',
      solution: (k) => {
        const rosePrice = 90;
        const ivanMoney = 55 + 120 * k;
        const maxRoses = Math.floor(ivanMoney / rosePrice);

        let numRoses = maxRoses;
        if (numRoses % 2 === 0) { // If maxRoses is even, decrease by 1 to make it odd
          numRoses = maxRoses - 1;
        }
        if (numRoses < 0) numRoses = 0; // Cannot buy negative roses

        return `
                        <p class="mb-2">1. Стоимость одной розы: ${rosePrice} рублей.</p>
                        <p class="mb-2">2. У Вани есть: $55 + 120 \\cdot ${k} = ${ivanMoney}$ рублей.</p>
                        <p class="mb-2">3. Максимальное количество роз, которое можно купить: $\\lfloor \\frac{${ivanMoney}}{${rosePrice}} \\rfloor = ${maxRoses}$.</p>
                        <p class="mb-2">4. Поскольку букет должен быть из нечётного числа роз, находим наибольшее нечётное число, не превышающее ${maxRoses}:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">${numRoses}</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${numRoses} роз</span></p>
                    `;
      }
    },
    {
      id: 14,
      category: 'Геометрия',
      question: 'Площадь боковой поверхности конуса равна $(5+3k)\\pi$, а образующая равна $3+k$. Найдите радиус основания конуса.',
      solution: (k) => {
        const lateralArea = (5 + 3 * k) * Math.PI;
        const slantHeight = 3 + k; // образующая
        let radius;

        if (slantHeight <= 0 || lateralArea <= 0) {
          return `
                            <p class="mb-2 text-red-600">Некорректные значения: Площадь боковой поверхности или образующая не могут быть отрицательными или равны нулю. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (некорректные данные)</span></p>
                        `;
        }

        // Lateral Area of Cone = pi * r * l
        // r = Lateral Area / (pi * l)
        radius = lateralArea / (Math.PI * slantHeight);

        return `
                        <p class="mb-2">1. Площадь боковой поверхности конуса: $S_{бок} = (5 + 3k)\\pi = ${(5 + 3 * k) * Math.PI.toFixed(2)}$</p>
                        <p class="mb-2">2. Образующая конуса (l): $l = 3 + k = ${slantHeight}$</p>
                        <p class="mb-2">3. Формула площади боковой поверхности конуса: $S_{бок} = \\pi R l$</p>
                        <p class="mb-2">4. Выразим радиус $R$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$R = \\frac{S_{бок}}{\\pi l} = \\frac{(${5 + 3 * k})\\pi}{\\pi (${3 + k})} = \\frac{${5 + 3 * k}}{${3 + k}}$</p>
                        <p class="mb-2">5. Вычислим радиус для k=${k}:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$R = \\frac{${5 + 3 * k}}{${3 + k}} = ${radius.toFixed(3)}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${radius.toFixed(3)}</span></p>
                    `;
      }
    },
    {
      id: 15,
      category: 'Геометрия',
      question: 'Основанием четырёхугольной пирамиды является прямоугольник со сторонами $12k$ и $5+k$. Найдите объем пирамиды, если ее высота равна $6k$.',
      solution: (k) => {
        const side1 = 12 * k;
        const side2 = 5 + k;
        const height = 6 * k;
        const baseArea = side1 * side2;
        let volume = 0;

        if (side1 <= 0 || side2 <= 0 || height <= 0) {
          return `
                            <p class="mb-2 text-red-600">Некорректные значения: Стороны основания или высота пирамиды не могут быть отрицательными или равны нулю. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (некорректные данные)</span></p>
                        `;
        }
        volume = (1 / 3) * baseArea * height;

        return `
                        <p class="mb-2">1. Стороны основания прямоугольника: $a = 12k = ${side1}$, $b = 5+k = ${side2}$.</p>
                        <p class="mb-2">2. Площадь основания $S_{осн} = a \\cdot b = ${side1} \\cdot ${side2} = ${baseArea}$.</p>
                        <p class="mb-2">3. Высота пирамиды: $H = 6k = ${height}$.</p>
                        <p class="mb-2">4. Объем пирамиды вычисляется по формуле $V = \\frac{1}{3} S_{осн} H$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$V = \\frac{1}{3} \\cdot ${baseArea} \\cdot ${height} = ${volume}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${volume}</span></p>
                    `;
      }
    },
    {
      id: 16,
      category: 'Геометрия',
      question: 'Даны два шара с радиусами $6+k$ и $2+k$. Во сколько раз объем большего шара больше площади поверхности меньшего?',
      solution: (k) => {
        const radius1 = 6 + k; // Updated radius1
        const radius2 = 2 + k;

        if (radius1 <= 0 || radius2 <= 0) {
          return `
                            <p class="mb-2 text-red-600">Некорректные значения: Радиусы шаров не могут быть отрицательными или равны нулю. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (некорректные данные)</span></p>
                        `;
        }

        const largerRadius = Math.max(radius1, radius2);
        const smallerRadius = Math.min(radius1, radius2);

        const volumeLarger = (4/3) * Math.PI * largerRadius**3;
        const surfaceAreaSmaller = 4 * Math.PI * smallerRadius**2;

        let ratio = 0;
        if (surfaceAreaSmaller !== 0) {
          ratio = volumeLarger / surfaceAreaSmaller;
        } else {
          return `
                            <p class="mb-2 text-red-600">Площадь поверхности меньшего шара равна нулю, деление невозможно. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (деление на ноль)</span></p>
                        `;
        }


        return `
                        <p class="mb-2">1. Радиусы шаров (для k=${k}): $R_1 = 6 + k = ${radius1}$, $R_2 = 2 + k = ${radius2}$.</p>
                        <p class="mb-2">2. Больший радиус: ${largerRadius}. Меньший радиус: ${smallerRadius}.</p>
                        <p class="mb-2">3. Объем большего шара: $V_{большего} = \\frac{4}{3}\\pi R_{большего}^3 = \\frac{4}{3}\\pi (${largerRadius})^3 = ${(volumeLarger/Math.PI).toFixed(2)}\\pi$</p>
                        <p class="mb-2">4. Площадь поверхности меньшего шара: $S_{меньшего} = 4\\pi R_{меньшего}^2 = 4\\pi (${smallerRadius})^2 = ${(surfaceAreaSmaller/Math.PI).toFixed(2)}\\pi$</p>
                        <p class="mb-2">5. Отношение объема большего шара к площади поверхности меньшего:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$\\frac{V_{большего}}{S_{меньшего}} = \\frac{\\frac{4}{3}\\pi (${largerRadius})^3}{4\\pi (${smallerRadius})^2} = \\frac{(${largerRadius})^3}{3(${smallerRadius})^2} = ${ratio.toFixed(2)}$</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">В ${ratio.toFixed(2)} раз</span></p>
                    `;
      }
    },
    {
      id: 17,
      category: 'Геометрия',
      question: 'Найдите площадь полной поверхности цилиндра, диаметр которого равен $(5+3k)$ мм, а высота в 3.7 раза больше радиуса. Ответ округлите до целых.',
      solution: (k) => {
        const diameter = 5 + 3 * k; // Updated diameter formula
        const radius = diameter / 2;
        const height = 3.7 * radius;
        let surfaceArea = 0;

        if (diameter <= 0) {
          return `
                            <p class="mb-2 text-red-600">Некорректные значения: Диаметр цилиндра не может быть отрицательным или равен нулю. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (некорректные данные)</span></p>
                        `;
        }
        surfaceArea = 2 * Math.PI * radius * (radius + height);

        return `
                        <p class="mb-2">1. Диаметр цилиндра: $D = 5 + 3k = ${diameter}$ мм.</p>
                        <p class="mb-2">2. Радиус цилиндра: $R = D/2 = ${radius}$ мм.</p>
                        <p class="mb-2">3. Высота цилиндра: $H = 3.7R = 3.7 \\cdot ${radius} = ${height.toFixed(2)}$ мм.</p>
                        <p class="mb-2">4. Площадь полной поверхности цилиндра вычисляется по формуле $S = 2\\pi R(R + H)$:</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">$S = 2\\pi (${radius})(${radius} + ${height.toFixed(2)}) = ${surfaceArea.toFixed(2)}\\pi$ мм².</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${Math.round(surfaceArea)} мм² (округлено до целых)</span></p>
                    `;
      }
    },
    {
      id: 18,
      category: 'Геометрия',
      question: 'Ящик, имеющий форму куба с ребром $20k$ см, если одной грани нужно покрасить все внутренние поверхности, а две остальные не покрашены. Найдите площадь поверхности, которую необходимо покрасить. Ответ дайте в квадратных сантиметрах.',
      solution: (k) => {
        const side = 20 * k;
        let paintedArea = 0;

        if (side <= 0) {
          return `
                            <p class="mb-2 text-red-600">Некорректные значения: Ребро куба не может быть отрицательным или равно нулю. Проверьте значение k.</p>
                            <p class="font-bold text-lg">Ответ: <span class="text-red-600">Невозможно вычислить (некорректные данные)</span></p>
                        `;
        }

        // A cube has 6 faces. If one face is open (the "missing" lid),
        // and two other faces are not painted, then 6 - 1 - 2 = 3 faces are painted.
        // However, the question states "одной грани нужно покрасить все внутренние поверхности, а две остальные не покрашены".
        // This implies the box is open on one side (e.g., a lid is missing).
        // So we have 5 inner surfaces. If 2 of the remaining 5 are *not* painted, then 3 surfaces are painted.
        // Re-reading: "одной грани нужно покрасить все внутренние поверхности" implies one face is painted on the inside.
        // This phrasing is ambiguous. Let's assume it means "all inner surfaces of the box".
        // A typical box has 6 faces. If "одной грани" means "one face is removed" (like a lid),
        // then there are 5 inner surfaces to paint. If 2 of the *remaining* surfaces are not painted,
        // that leaves 3 inner surfaces.
        // If it means "one face (the one that is the 'lid' or opening) needs to be painted on all internal surfaces (of the remaining 5)"
        // this seems to imply a single internal surface.
        // Given the wording "все внутренние поверхности", it usually implies the interior of the whole container.
        // Let's assume it means the internal surfaces of the box, with two specific faces excluded.
        // A more common interpretation: "одной грани" refers to the entire cube, and "все внутренние поверхности"
        // refers to the inner walls of a *container* that is a cube, missing 1 side (the opening).
        // So, 5 faces are inner. Then "а две остальные не покрашены" implies 2 of these 5 are not painted.
        // Thus, 5 - 2 = 3 faces are painted.
        // Or, if "одной грани" refers to one of the 6 faces being chosen, and its *interior* is painted,
        // this would be one face's area. This seems too simple.
        // Let's go with the interpretation: a cube-shaped box, one side is open (not painted),
        // and two *more* sides are explicitly not painted from the remaining 5.
        // This leads to 5 - 2 = 3 faces being painted.
        // Or, if it means the internal surfaces of the box which has *one* side that needs painting
        // and two other sides are not painted. This is the most complex interpretation.

        // Given the simplicity of typical math problems, the most straightforward interpretation:
        // A cube has 6 faces. One face is explicitly for "internal surfaces" (meaning, the interior of the box).
        // So we're painting the interior of the box. An open box (like a container) has 5 internal surfaces.
        // If 2 *more* surfaces are NOT painted from these 5, then 5 - 2 = 3 surfaces are painted.
        // The phrasing is tricky. "одной грани нужно покрасить все внутренние поверхности"
        // could mean "one specific face is painted on its inside (facing the interior of the box), and two others are not painted."
        // This still implies painting the *inside* of the box.

        // Let's assume the question implies painting the *interior* of a cube-shaped container,
        // which implicitly has an opening (e.g., a missing lid). So 5 faces are paintable on the inside.
        // Then, "а две остальные не покрашены" means 2 more are excluded. So 5 - 2 = 3 faces.
        // Area of one face = side * side
        // Total painted area = 3 * (side * side)

        paintedArea = 3 * side * side; // Assuming 3 faces are painted

        return `
                        <p class="mb-2">1. Длина ребра куба: $a = 20k = ${side}$ см.</p>
                        <p class="mb-2">2. Площадь одной грани куба: $S_{грани} = a^2 = ${side}^2 = ${side * side}$ см².</p>
                        <p class="mb-2">3. Интерпретируем условие: ящик в форме куба, одна "грань" (сторона) это отверстие, и две другие "грани" из оставшихся также не покрашены. Это означает, что $6 - 1 - 2 = 3$ внутренних грани будут покрашены.</p>
                        <p class="mb-4 p-2 bg-gray-100 rounded-md font-mono">Площадь для покраски = 3 $\\times$ $S_{грани} = 3 \\cdot ${side * side} = ${paintedArea}$ см².</p>
                        <p class="font-bold text-lg">Ответ: <span class="text-green-700">${paintedArea} см²</span></p>
                    `;
      }
    }
  ];

  const taskNavContainer = document.getElementById('task-navigation');
  const taskContentContainer = document.getElementById('task-content');
  const categoryFiltersContainer = document.getElementById('category-filters');
  const kInput = document.getElementById('k-input');
  const applyKButton = document.getElementById('apply-k-button');
  const currentKDisplay = document.getElementById('current-k-display');

  let currentK = parseInt(kInput.value, 10);
  let activeTask = 1;
  let activeCategory = 'Все';
  let charts = {};

  const categories = ['Все', ...new Set(tasks.map(t => t.category))];

  function updateCurrentK(newK) {
    currentK = newK;
    currentKDisplay.textContent = `k = ${currentK}`;
  }

  function renderNav() {
    taskNavContainer.innerHTML = '';
    tasks.forEach(task => {
      const isVisible = activeCategory === 'Все' || task.category === activeCategory;
      const button = document.createElement('button');
      button.textContent = task.id;
      button.className = `nav-button w-12 h-12 rounded-lg font-bold flex items-center justify-center ${task.id === activeTask ? 'active' : ''} ${isVisible ? 'opacity-100' : 'opacity-30'}`;
      button.onclick = () => {
        activeTask = task.id;
        render();
      };
      taskNavContainer.appendChild(button);
    });
  }

  function renderCategories() {
    categoryFiltersContainer.innerHTML = '';
    categories.forEach(category => {
      const button = document.createElement('button');
      button.textContent = category;
      button.className = `category-button px-3 py-1 rounded-full text-sm font-semibold ${category === activeCategory ? 'active' : ''}`;
      button.onclick = () => {
        activeCategory = category;
        render();
      };
      categoryFiltersContainer.appendChild(button);
    });
  }

  function renderTask() {
    const task = tasks.find(t => t.id === activeTask);
    if (!task) return;

    const solutionContent = typeof task.solution === 'function' ? task.solution(currentK) : task.solution;

    taskContentContainer.innerHTML = `
                <div class="task-card p-6 rounded-xl">
                    <h2 class="text-xl font-bold mb-4">Задание ${task.id} <span class="text-sm font-medium text-gray-500 ml-2">(${task.category})</span></h2>
                    <div class="prose max-w-none mb-6">${task.question}</div>
                    <button class="solution-toggle px-4 py-2 rounded-lg font-semibold mb-4" onclick="toggleSolution(this)">Показать решение</button>
                    <div class="solution-content p-4 rounded-lg hidden">${solutionContent}</div>
                </div>
            `;

    if (window.MathJax && window.MathJax.typesetPromise) {
      window.MathJax.typesetPromise([taskContentContainer]);
    }

    // Removed chart rendering calls as they are no longer applicable to the new set of tasks.
  }

  function toggleSolution(button) {
    const solutionDiv = button.nextElementSibling;
    const isHidden = solutionDiv.classList.contains('hidden');
    if (isHidden) {
      solutionDiv.classList.remove('hidden');
      button.textContent = 'Скрыть решение';
    } else {
      solutionDiv.classList.add('hidden');
      button.textContent = 'Показать решение';
    }
  }

  function render() {
    renderNav();
    renderCategories();
    renderTask();
  }

  function destroyChart(id) {
    if (charts[id]) {
      charts[id].destroy();
      delete charts[id];
    }
  }

  // Removed renderTask12Chart and renderTask13Chart as they are not applicable to the new set of tasks.

  applyKButton.addEventListener('click', () => {
    const newKValue = parseInt(kInput.value, 10);
    if (!isNaN(newKValue) && newKValue > 0) {
      updateCurrentK(newKValue);
      render();
    } else {
      alert('Пожалуйста, введите корректное положительное число для k.');
      kInput.value = currentK; // Reset to previous valid value
    }
  });

  document.addEventListener('DOMContentLoaded', () => {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
    script.async = true;
    script.onload = () => {
      if (window.MathJax && window.MathJax.startup && window.MathJax.startup.promise) {
        window.MathJax.startup.promise.then(() => {
          updateCurrentK(parseInt(kInput.value, 10));
          render();
        });
      } else {
        console.error('MathJax not fully loaded or configured.');
        updateCurrentK(parseInt(kInput.value, 10));
        render();
      }
    };
    script.onerror = () => {
      console.error('Failed to load MathJax script.');
      updateCurrentK(parseInt(kInput.value, 10));
      render();
    };
    document.head.appendChild(script);

    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
  });

</script>
</body>
</html>